import{bN as J,pH as _e,pI as tt,pJ as it,cq as b,cH as we,pb as ae,kP as N,nb as Ue,kN as O,ds as We,dr as de,p1 as nt,pK as ot,fu as Te,bk as oe,bO as rt,bC as st,pL as Le,bv as Ae,cI as at,ak as lt,pM as pt,fl as Ne,kM as E,pN as ct,dF as ge,pO as ht,dt as ut,ai as s,aj as l,al as z,cb as dt,cd as ye,pP as re,er as se,ev as gt,aL as A,ah as G,aP as yt,bf as mt,pQ as me,jK as vt,aR as ie,b6 as ft,pR as xt,eu as _t,pS as wt,ey as Tt,hX as be,gL as bt,l2 as Ot,b8 as Mt,i3 as Oe,hD as je,hW as qe,kS as St,cr as Vt,iC as B,pT as Me,hj as Se,pU as Ve,ne as Ye,kE as U,n3 as Y,oV as Ie,pV as It,pW as $t,en as Ct,kD as le,kF as $e,kO as T,n6 as Ce,pc as Pt,dR as pe}from"./index-4e7cdbf0.js";import{m as I,U as j,r as Pe,s as Re}from"./quantityFormatUtils-ff29e62c.js";import{simplify as Rt,distance as Gt}from"./geometryEngine-7f801ff7.js";import{s as zt}from"./centroid-95e8df64.js";import{l as Et,d as ce,C as Dt}from"./InteractiveToolBase-7d85d331.js";import{t as q,p as kt,s as he,d as Ht,a as K}from"./automaticLengthMeasurementUtils-1eb9d49a.js";import{o as Ge}from"./automaticAreaMeasurementUtils-6801e194.js";import{r as ze}from"./dehydratedFeatureComparison-d8e6ffe2.js";import{w as Zt,_ as Ft,p as Ut,l as Wt,t as Lt,a as At,s as Nt,c as jt}from"./EditGeometryOperations-642c6092.js";import{e as Ee}from"./SnappingContext-06ffe599.js";import{p as qt,f as Yt}from"./SnappingOperation-58dfc7fe.js";function ne(t,e,i=null){return i!=null?[t,e,i]:[t,e]}function v(t,e,i=null){return i!=null?{x:t,y:e,z:i}:{x:t,y:e}}let Be=class{constructor(e){this.spatialReference=e}mapToLocalMultiple(e){return e.map(i=>this.mapToLocal(i)).filter(oe)}get doUnnormalization(){return!1}};class Bt extends Be{constructor(e,i,n=null){super(i),this._defaultZ=n,this.transform=_e(),this.transformInv=_e(),this.transform=tt(e),it(this.transformInv,this.transform)}makeMapPoint(e,i){return ne(e,i,this._defaultZ)}mapToLocal(e){return v(this.transform[0]*e[0]+this.transform[2]*e[1]+this.transform[4],this.transform[1]*e[0]+this.transform[3]*e[1]+this.transform[5])}localToMap(e){return ne(this.transformInv[0]*e.x+this.transformInv[2]*e.y+this.transformInv[4],this.transformInv[1]*e.x+this.transformInv[3]*e.y+this.transformInv[5],this._defaultZ)}}let Jt=class extends Be{constructor(e,i){super(e.spatialReference),this.view=e,this.defaultZ=null,this.pWS=b(),this.tangentFrameUpWS=b(),this.tangentFrameRightWS=b(),this.tangentFrameForwardWS=b(),this.localFrameRightWS=b(),this.localFrameUpWS=b(),this.worldToLocalTransform=we(),this.localToWorldTransform=we(),this.scale=1,this.scale=e.resolution,this.referenceMapPoint=i,this.defaultZ=i.hasZ?i.z:null;const n=e.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,ae.X,this.tangentFrameRightWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,ae.Y,this.tangentFrameUpWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,ae.Z,this.tangentFrameForwardWS);const o=b();N(o,this.tangentFrameForwardWS,Ue(n,this.tangentFrameForwardWS)),O(this.localFrameRightWS,n,o),We(this.localFrameRightWS,this.localFrameRightWS),de(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS),nt(this.worldToLocalTransform,this.localFrameRightWS,this.tangentFrameRightWS),ot(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return this.view.viewingMode==="global"}makeMapPoint(e,i){return ne(e,i,this.defaultZ)}mapToLocal(e){const i=b();this.view.renderCoordsHelper.toRenderCoords(new J({x:e[0],y:e[1],spatialReference:this.spatialReference}),i),Te(i,i,this.worldToLocalTransform);const n=this.view.renderCoordsHelper.fromRenderCoords(i,this.view.spatialReference);return n!=null?v(n.x/this.scale,n.y/this.scale):null}localToMap(e){const i=b();this.view.renderCoordsHelper.toRenderCoords(new J({x:e.x*this.scale,y:e.y*this.scale,spatialReference:this.spatialReference}),i),Te(i,i,this.localToWorldTransform);const n=this.view.renderCoordsHelper.fromRenderCoords(i,this.view.spatialReference);return n!=null?ne(n.x,n.y,this.defaultZ):null}};function De(t,e){if(t.type==="2d")return new Bt(t.state.transform,t.spatialReference,e.length>2?e[2]:null);if(t.type==="3d"){const i=e.length>2?new J({x:e[0],y:e[1],z:e[2],spatialReference:t.spatialReference}):new J({x:e[0],y:e[1],spatialReference:t.spatialReference});return new Jt(t,i)}return null}function Z(t,e){const i=new J({x:t[0],y:t[1],spatialReference:e});return t.length>2&&(i.z=t[2]),i}function Kt(t,e){return new rt({points:t,spatialReference:e})}function ke(t,e,i){const n=new st({paths:t,spatialReference:e});return i&&Le(n),n}function F(t,e,i,n=!0){const o=Ae(t);o.forEach(p=>{const a=p[0],c=p[p.length-1];at(a,c)&&p.length!==1||p.push(p[0])});let r=new lt({rings:o,spatialReference:e});return r.rings.forEach(p=>{pt(p,!1,!1)||p.reverse()}),i&&Le(r),n&&r.isSelfIntersecting&&Ne(e)&&(r=Rt(r)),r}function He(t,e,i){const n=e.mapToLocalMultiple(t),o=[],r={x:n[0].x,y:n[0].y},p={x:n[1].x,y:n[1].y},a=Math.round(p.x-r.x),c=Math.round(p.y-r.y),g=Math.max(Math.abs(a),Math.abs(c));if(i){const u={x:r.x+g,y:r.y+g},y={x:r.x-g,y:r.y-g};o.push(v(u.x,y.y),v(y.x,y.y),v(y.x,u.y),v(u.x,u.y))}else{const u={x:a>0?r.x+g:r.x-g,y:c>0?r.y+g:r.y-g};o.push(v(r.x,r.y),v(u.x,r.y),v(u.x,u.y),v(r.x,u.y))}return Je(F([o.map(u=>e.localToMap(u)).filter(oe)],e.spatialReference,e.doUnnormalization,!0),o,e)}function Qt(t,e,i){let n=e.mapToLocalMultiple(t);if(n.length===1){const c=n[0];n=[v(c.x-48,c.y+48),v(c.x+48,c.y-48),v(c.x+48,c.y-48),v(c.x-48,c.y+48)]}const o=[],r={x:n[0].x,y:n[0].y},p={x:n[1].x,y:n[1].y};if(i){const a=Math.round(p.x-r.x),c=Math.round(p.y-r.y);o.push(v(r.x-a,r.y-c),v(p.x,r.y-c),v(p.x,p.y),v(r.x-a,p.y))}else o.push(v(r.x,r.y),v(p.x,r.y),v(p.x,p.y),v(r.x,p.y));return Je(F([o.map(a=>e.localToMap(a)).filter(oe)],e.spatialReference,e.doUnnormalization,!0),o,e)}function Je(t,e,i){const n=Q(e[3],e[2],i),o=Q(e[1],e[2],i),r=Q(e[0],e[1],i),p=Q(e[0],e[3],i);return{geometry:t,midpoints:n!=null&&o!=null&&r!=null&&p!=null?{top:n,right:o,bottom:r,left:p}:null}}function Q(t,e,i){W[0]=t.x,W[1]=t.y,W[2]=0,L[0]=e.x,L[1]=e.y,L[2]=0,E(W,W,L,.5),X.x=W[0],X.y=L[1],X.z=L[2];const n=i.localToMap(X);return n!=null?Z(n,i.spatialReference):null}const X=v(0,0,0),W=b(),L=b();function Ze(t,e,i,n){const o=e.mapToLocalMultiple(t);let r=null,p=null;if(i)r=o[0],p=o[1];else{const x=o[0],_=o[1],w=Math.round(_.x-x.x),M=Math.round(_.y-x.y),S=Math.max(Math.abs(w),Math.abs(M));r=v(w>0?x.x+S/2:x.x-S/2,M>0?x.y+S/2:x.y-S/2),p=v(Math.abs(w)>Math.abs(M)?r.x-S/2:r.x,Math.abs(w)>Math.abs(M)?r.y:r.y-S/2)}const a=e.localToMap(r),c=e.localToMap(p);if(a==null||c==null)return null;e.doUnnormalization&&ct([[a,c]],e.spatialReference);const g=Z(a,e.spatialReference),u=Z(c,e.spatialReference),y=ge(e.spatialReference);let m=0;if(Ne(e.spatialReference))m=y*Gt(g,u,null);else{const x=r.x-p.x,_=r.y-p.y;m=y*Math.sqrt(x*x+_*_)*(n||1)}const h=new ht({center:g,radius:m,radiusUnit:"meters",spatialReference:e.spatialReference});return{geometry:F(h.rings,h.spatialReference,!1),center:g,edge:u}}function Xt(t,e,i){const n=e.mapToLocalMultiple(t),o=n[0],r=n[1],p=Math.round(r.x-o.x),a=Math.round(r.y-o.y),c=v(i?o.x:o.x+p/2,i?o.y:o.y+a/2),g=i?p:p/2,u=i?a:a/2,y=60,m=[],h=2*Math.PI/y;function x($){const Xe=Math.cos($),et=Math.sin($);return v(g*Xe+c.x,u*et+c.y)}for(let $=0;$<y;$++)m.push(x($*h));m.push(m[0]);const{spatialReference:_,doUnnormalization:w}=e,M=F([m.map($=>e.localToMap($)).filter(oe)],_,w,!1),S=e.localToMap(x(Math.PI/2)),ve=e.localToMap(x(0)),fe=e.localToMap(x(-Math.PI/2)),xe=e.localToMap(x(Math.PI));return{geometry:M,midpoints:S!=null&&ve!=null&&fe!=null&&xe!=null?{top:Z(S,_),right:Z(ve,_),bottom:Z(fe,_),left:Z(xe,_)}:null}}function ee(t,e,i){switch(t){case"point":case"multipoint":return"point";case"polyline":return(e!=null&&e.type==="polyline"&&e.paths.length?e.paths[0].length:0)<2?"polylineZeroVertices":"polylineOneVertex";case"polygon":{const n=e!=null&&e.type==="polygon"&&e.rings.length?e.rings[0].length:0;return n<3?"polylineZeroVertices":n<4?"polygonOneVertex":"polygonTwoVertices"}case"mesh":return ei(e,i);default:return}}function ei(t,e){if((t==null?void 0:t.type)!=="mesh"||(e==null?void 0:e.type)!=="3d")return;const{renderCoordsHelper:i}=e,{camera:n}=e.state,{width:o,height:r,zmin:p,zmax:a,center:c,spatialReference:g}=t.extent,u=(a??0)-(p??0),y=ge(g),m=zt(g),h=ge(i.spatialReference),x=Math.max(o*y,r*y,u*m)/h;ut(te,c.x,c.y,c.z??0),i.toRenderCoords(te,g,te);const _=x/n.computeScreenPixelSizeAt(te);return _>n.width*ii?"meshTooClose":_<ti?"meshTooFar":"mesh"}const ti=20,ii=1,te=b();let D=class extends q{constructor(t){super(t),this.type="draw-point"}};s([l()],D.prototype,"type",void 0),s([l()],D.prototype,"elevation",void 0),s([l()],D.prototype,"viewType",void 0),s([l()],D.prototype,"helpMessage",void 0),D=s([z("esri.views.interactive.tooltip.DrawPointTooltipInfo")],D);let C=class extends q{constructor(t){super(t),this.type="draw-polyline",this.totalLength=I}};s([l()],C.prototype,"type",void 0),s([l()],C.prototype,"elevation",void 0),s([l()],C.prototype,"totalLength",void 0),s([l()],C.prototype,"viewType",void 0),s([l()],C.prototype,"helpMessage",void 0),C=s([z("esri.views.interactive.tooltip.DrawPolylineTooltipInfo")],C);let P=class extends q{constructor(t){super(t),this.type="draw-polygon",this.area=j}};s([l()],P.prototype,"type",void 0),s([l()],P.prototype,"elevation",void 0),s([l()],P.prototype,"area",void 0),s([l()],P.prototype,"viewType",void 0),s([l()],P.prototype,"helpMessage",void 0),P=s([z("esri.views.interactive.tooltip.DrawPolygonTooltipInfo")],P);let k=class extends q{constructor(e){super(e),this.type="draw-mesh"}};s([l()],k.prototype,"type",void 0),s([l()],k.prototype,"elevation",void 0),s([l()],k.prototype,"viewType",void 0),s([l()],k.prototype,"helpMessage",void 0),k=s([z("esri.views.interactive.tooltip.DrawMeshTooltipInfo")],k);let H=class extends q{constructor(t){super(t),this.type="draw-rectangle",this.xSize=I,this.ySize=I,this.area=j}};s([l()],H.prototype,"type",void 0),s([l()],H.prototype,"xSize",void 0),s([l()],H.prototype,"ySize",void 0),s([l()],H.prototype,"area",void 0),H=s([z("esri.views.interactive.tooltip.DrawRectangleTooltipInfo")],H);let R=class extends q{constructor(t){super(t),this.type="draw-circle",this.radius=null,this.xSize=null,this.ySize=null,this.area=j}};s([l()],R.prototype,"type",void 0),s([l()],R.prototype,"radius",void 0),s([l()],R.prototype,"xSize",void 0),s([l()],R.prototype,"ySize",void 0),s([l()],R.prototype,"area",void 0),R=s([z("esri.views.interactive.tooltip.DrawCircleTooltipInfo")],R);class ni{constructor(){this.regularVertices=null,this.activeVertex=null,this.full=null,this.outline=null,this.circle=null,this.rectangle=null}}let d=class extends dt(ye.EventedMixin(Et)){constructor(e){super(e),this._graphic=null,this._createOperationGeometry=null,this.defaultZ=0,this.geometryType=null,this.hasZ=!0,this.labelOptions=new re,this.geometryToPlace=null,this.mode=null,this.snappingManager=null,this.snapToScene=!1,this.tooltip=null,this.tooltipOptions=new se}initialize(){this.internalGraphicsLayer=new gt({listMode:"hide",internal:!0}),this.view.map.layers.add(this.internalGraphicsLayer),this.drawOperation=this.makeDrawOperation(),this.handles.add([this.drawOperation.on("vertex-add",e=>this.onVertexAdd(e)),this.drawOperation.on("vertex-remove",e=>this.onVertexRemove(e)),this.drawOperation.on("vertex-update",e=>this.onVertexUpdate(e)),this.drawOperation.on("cursor-update",e=>this.onCursorUpdate(e)),this.drawOperation.on("complete",e=>this.onComplete(e)),A(()=>this.tooltipOptions.enabled,e=>{this.tooltip=e?new Ht({view:this.view,info:this._tooltipInfo}):G(this.tooltip)},ie),A(()=>this._tooltipInfo,e=>{this.tooltip!=null&&(this.tooltip.info=e)},ie)]),this.finishToolCreation()}destroy(){this.drawOperation=G(this.drawOperation),this.tooltip=G(this.tooltip),this._destroyAllVisualisations(),this.view.map.remove(this.internalGraphicsLayer),this.internalGraphicsLayer=G(this.internalGraphicsLayer),this._set("view",null)}get _defaultElevation(){return Pe(this.defaultZ,"meters")}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centered(e){this._set("centered",e),this._updateGraphic()}set enabled(e){this.drawOperation.interactive=e,this._set("enabled",e)}set forceUniformSize(e){this._set("forceUniformSize",e),this._updateGraphic()}get graphic(){return this._graphic}set graphicSymbol(e){this._set("graphicSymbol",e),this._graphic!=null&&(this._graphic.symbol=e)}get updating(){var e;return((e=this.drawOperation)==null?void 0:e.updating)??!1}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(e){this.drawOperation.onInputEvent(e)}redo(){this.drawOperation.redo()}reset(){}undo(){this.drawOperation.undo()}_destroyAllVisualisations(){this.handles.remove(V.outline),this.handles.remove(V.regularVertices),this.handles.remove(V.activeVertex),this.handles.remove(ue)}_createOrUpdateGraphic(e){if(this._graphic!=null)return this._updateGraphicGeometry(this._graphic,e),this._graphic;const i=this._graphic=new yt({...this.graphicProperties,symbol:this.graphicSymbol});return this._updateGraphicGeometry(i,e),this.internalGraphicsLayer.add(i),this.handles.add(this.initializeGraphic(i)),this.notifyChange("graphic"),this.handles.add(mt(()=>{this.internalGraphicsLayer.remove(i),G(i),this._graphic===i&&(this._graphic=null)}),ue),i}_updateGraphicGeometry(e,i){e.geometry=i}_getCreateOperationGeometry(e={operationComplete:!1}){var x;const{drawOperation:i}=this;if(i==null||i.numVertices===0)return null;const{coordinateHelper:n,view:o}=i,r=i.stagedVertex,p=i.committedVertices,a=p.slice(),c=r!=null;c&&a.push(n.pointToArray(r));const g=c?n.pointToArray(r):p.splice(-1)[0],u=a.length,y=o.spatialReference,m=o.type==="3d"&&o.viewingMode==="global",h=new ni;switch(this.geometryType){case"point":case"mesh":h.regularVertices=p,h.activeVertex=g,h.full=n.arrayToPoint(a[0]);break;case"multipoint":h.regularVertices=p,h.activeVertex=g,u>0&&(h.full=Kt(a,y));break;case"polyline":h.regularVertices=p,h.activeVertex=g,u>0&&(h.full=ke([a],y,m));break;case"polygon":h.regularVertices=p,h.activeVertex=g,u>0&&(h.full=F([a],y,m,!0));break;case"circle":if(u>0){const _=De(o,a[0]);if(u===1&&e.operationComplete){const w=a[0],M=_.makeMapPoint(w[0]+Fe*o.resolution,w[1]);h.circle=Ze([w,M],_,!0),h.full=h.circle!=null?h.circle.geometry:null}else u===2&&(this.forceUniformSize?(h.circle=Ze(a,_,this.centered),h.full=h.circle!=null?h.circle.geometry:null):(h.rectangle=Xt(a,_,this.centered),h.full=h.rectangle.geometry))}break;case"rectangle":if(u>0){const _=De(o,a[0]);if(u===1&&e.operationComplete){const w=a[0],M=_.makeMapPoint(w[0]+Fe*o.resolution,w[1]);h.rectangle=He([w,M],_,!0),h.full=h.rectangle.geometry}else u===2&&(h.rectangle=this.forceUniformSize?He(a,_,this.centered):Qt(a,_,this.centered),h.full=h.rectangle.geometry)}break;default:return null}switch(this.geometryType){case"point":case"multipoint":break;case"polyline":h.outline=u>1?ke([a],y,m):null;break;case"polygon":h.outline=u>1?F([a],y,m):null;break;case"circle":case"rectangle":h.outline=((x=h.full)==null?void 0:x.type)==="polygon"?F(h.full.rings,y,m):null}return h}initializeGraphic(e){return null}onComplete(e){this._updateGraphic();let i=null;if(this.drawOperation.isCompleted){const n=this._getCreateOperationGeometry({operationComplete:!0});n!=null&&(i=this._createOrUpdateGraphic(n.full).clone())}this._createOperationGeometry=null,this.emit("complete",{graphic:i,...e})}onCursorUpdate(e){this._updateGraphic(),this.emit("cursor-update",e)}onDeactivate(){this.drawOperation.isCompleted||this.drawOperation.cancel()}onVertexAdd(e){this._updateGraphic(),this.emit("vertex-add",e)}onVertexRemove(e){this._updateGraphic(),this.emit("vertex-remove",e)}onVertexUpdate(e){this._updateGraphic(),this.emit("vertex-update",e)}_updateGraphic(){const e=this._getCreateOperationGeometry();this._createOperationGeometry=e,e!=null?(e.outline!=null?this.handles.add(this.onOutlineChanged(e.outline),V.outline):this.handles.remove(V.outline),e.regularVertices!=null?this.handles.add(this.onRegularVerticesChanged(e.regularVertices),V.regularVertices):this.handles.remove(V.regularVertices),e.activeVertex!=null?this.handles.add(this.onActiveVertexChanged(e.activeVertex),V.activeVertex):this.handles.remove(V.activeVertex),e.full!=null?this._createOrUpdateGraphic(e.full):this.handles.remove(ue)):this._destroyAllVisualisations()}get _tooltipInfo(){const{drawOperation:e}=this;if(!e)return null;switch(this.geometryType){case"point":return this._drawPointTooltipInfo;case"polyline":return this._drawPolylineTooltipInfo;case"polygon":return this._drawPolygonTooltipInfo;case"rectangle":return this._drawRectangleTooltipInfo;case"circle":return this._drawCircleTooltipInfo;case"mesh":return this._drawMeshTooltipInfo;default:return null}}get _drawPointTooltipInfo(){const{view:e,graphic:i}=this,n=i==null?void 0:i.geometry;return(n==null?void 0:n.type)!=="point"||e.type==="2d"&&this.defaultZ===0?null:new D({tooltipOptions:this.tooltipOptions,elevation:this._elevationTooltipDetail,viewType:e.type,helpMessage:ee("point",n,e)})}get _drawPolylineTooltipInfo(){const e=this._createOperationGeometry,i=e!=null?e.full:null;if((i==null?void 0:i.type)!=="polyline")return null;const n=kt(i,this._elevationMode),{view:o}=this;return new C({tooltipOptions:this.tooltipOptions,elevation:this._elevationTooltipDetail,totalLength:n??I,viewType:o.type,helpMessage:ee("polyline",i,o)})}get _drawPolygonTooltipInfo(){const e=this._createOperationGeometry,i=e!=null?e.full:null;if((i==null?void 0:i.type)!=="polygon")return null;const n=Ge(i,this._elevationMode),{view:o}=this;return new P({tooltipOptions:this.tooltipOptions,elevation:this._elevationTooltipDetail,area:n??j,viewType:o.type,helpMessage:ee("polygon",i,o)})}get _drawMeshTooltipInfo(){const{view:e,graphic:i}=this,n=i==null?void 0:i.geometry;return(n==null?void 0:n.type)!=="mesh"||e.type==="2d"&&this.defaultZ===0?null:new k({tooltipOptions:this.tooltipOptions,elevation:this._elevationTooltipDetail,viewType:e.type,helpMessage:ee("mesh",n,e)})}get _drawRectangleTooltipInfo(){return this.drawOperation==null?null:new H({tooltipOptions:this.tooltipOptions,xSize:this._xSize??I,ySize:this._ySize??I,area:this._fullGeometryArea??j})}get _drawCircleTooltipInfo(){if(this.drawOperation==null)return null;const e=this.forceUniformSize;return new R({tooltipOptions:this.tooltipOptions,radius:e?this._circleRadius??I:null,xSize:e?null:this._xSize??I,ySize:e?null:this._ySize??I,area:this._fullGeometryArea??j})}get _circleRadius(){const e=this._createOperationGeometry;return e!=null&&e.circle!=null&&e.circle.center!=null&&e.circle.edge!=null?he(e.circle.center,e.circle.edge,this._elevationMode):null}get _xSize(){const e=this._createOperationGeometry;if((e==null?void 0:e.rectangle)==null)return null;const{midpoints:i}=e.rectangle;return i!=null?he(i.left,i.right,this._elevationMode):null}get _ySize(){const e=this._createOperationGeometry;if((e==null?void 0:e.rectangle)==null)return null;const{midpoints:i}=e.rectangle;return i!=null?he(i.top,i.bottom,this._elevationMode):null}get _fullGeometryArea(){const e=this._createOperationGeometry,i=e!=null?e.full:null;return(i==null?void 0:i.type)!=="polygon"?null:Ge(i,this._elevationMode)}get _elevationTooltipDetail(){return{mode:this.drawOperation.elevationInfo.mode,...this._vertexTooltipElevation}}get _vertexTooltipElevation(){const{tooltipOptions:e,view:i,drawOperation:n}=this;if(n==null)return this._defaultElevation;const o=n.stagedVertex??n.lastVertex;if(o==null||i.type==="2d")return this._defaultElevation;const r={mode:e.elevation.mode,offset:0},p=(me(i,o,n.elevationInfo,r)??0)*vt(o.spatialReference);return Pe(p,"meters")}get _elevationMode(){return this.drawOperation.isDraped?"on-the-ground":"absolute-height"}};s([l()],d.prototype,"_createOperationGeometry",void 0),s([l()],d.prototype,"_defaultElevation",null),s([l({value:!0})],d.prototype,"centered",null),s([l({nonNullable:!0})],d.prototype,"defaultZ",void 0),s([l()],d.prototype,"drawOperation",void 0),s([l({value:!0})],d.prototype,"enabled",null),s([l({value:!0})],d.prototype,"forceUniformSize",null),s([l({constructOnly:!0})],d.prototype,"geometryType",void 0),s([l()],d.prototype,"graphic",null),s([l({constructOnly:!0})],d.prototype,"graphicProperties",void 0),s([l()],d.prototype,"graphicSymbol",null),s([l({constructOnly:!0})],d.prototype,"hasZ",void 0),s([l({constructOnly:!0,type:re})],d.prototype,"labelOptions",void 0),s([l({constructOnly:!0})],d.prototype,"geometryToPlace",void 0),s([l({constructOnly:!0})],d.prototype,"mode",void 0),s([l()],d.prototype,"snappingManager",void 0),s([l()],d.prototype,"snapToScene",void 0),s([l()],d.prototype,"tooltip",void 0),s([l({constructOnly:!0,type:se})],d.prototype,"tooltipOptions",void 0),s([l({readOnly:!0})],d.prototype,"type",void 0),s([l({readOnly:!0})],d.prototype,"updating",null),s([l({constructOnly:!0,nonNullable:!0})],d.prototype,"view",void 0),s([l()],d.prototype,"_tooltipInfo",null),s([l()],d.prototype,"_drawPointTooltipInfo",null),s([l()],d.prototype,"_drawPolylineTooltipInfo",null),s([l()],d.prototype,"_drawPolygonTooltipInfo",null),s([l()],d.prototype,"_drawMeshTooltipInfo",null),s([l()],d.prototype,"_drawRectangleTooltipInfo",null),s([l()],d.prototype,"_drawCircleTooltipInfo",null),s([l()],d.prototype,"_circleRadius",null),s([l()],d.prototype,"_xSize",null),s([l()],d.prototype,"_ySize",null),s([l()],d.prototype,"_fullGeometryArea",null),s([l()],d.prototype,"_elevationTooltipDetail",null),s([l()],d.prototype,"_vertexTooltipElevation",null),s([l()],d.prototype,"_elevationMode",null),d=s([z("esri.views.draw.DrawGraphicTool")],d);const ue="create-operation-graphic",V={outline:"outline-visual",regularVertices:"regular-vertices-visual",activeVertex:"active-vertex-visual"};function Oi(t){switch(t){case"point":case"polyline":case"polygon":case"multipoint":return t;case"circle":case"rectangle":return"segment";case"mesh":return"point"}}const Fe=48,Ke="click";class oi{constructor({grabbableForEvent:e}){this.events=new ye,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.grabbableForEvent=e}intersectionDistance(e,i){return 0}attach(){}detach(){}onElevationChange(){}onViewChange(){}}let f=class extends ye.EventedMixin(ft){constructor(t){super(t),this._createOperationCompleted=!1,this._pointerDownStates=new Set,this._stagedScreenPoint=null,this._stagedPointerType=null,this.isDraped=!0,this.labelOptions=new re,this.tooltipOptions=new se,this.cursor=null,this.loading=!1,this.snapToSceneEnabled=null,this.lastVertex=null,t.elevationInfo==null&&(this.elevationInfo=xt(!!t.hasZ))}initialize(){const{geometryType:t,view:e}=this,i=e.spatialReference,n="viewingMode"in e.state?e.state.viewingMode:_t.Local,o=t==="segment"||t==="multipoint"?"polyline":t;this.coordinateHelper=Zt(this.hasZ,this.hasM,i),this._editGeometryOperations=new Ft(new Ut(o,this.coordinateHelper)),this._snappingOperation=new qt({view:e,constrainResult:a=>{var c;return a==null?a:(c=this._getEffectiveDrawSurface())==null?void 0:c.constrainZ(a)}}),this.addHandles([A(()=>this.stagedVertex,a=>{a!=null&&this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(a)}],operation:"apply",type:"vertex-update"})},{sync:!0,equals:(a,c)=>Ot(a,c,ze)}),A(()=>this.view.viewpoint,(a,c)=>{a&&c&&Mt(a,c)&&this._onViewpointChange()})]),this._activeComponent=new Wt(i,n),this._editGeometryOperations.data.components.push(this._activeComponent);const r=this.segmentLabels;r!=null&&(r.context={view:e,editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,labelOptions:this.labelOptions},this.addHandles([A(()=>this.labelOptions.enabled,a=>{r.visible=a},ie),this.on("cursor-update",()=>{const a=this.stagedVertex;r.stagedVertex=a!=null?this.coordinateHelper.pointToVector(a):null})])),this.addHandles(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],a=>{const c=a.vertices.map(m=>({componentIndex:0,vertexIndex:m.index,coordinates:this.coordinateHelper.vectorToArray(m.pos)})),g=c.map(m=>m.coordinates);switch(a.type){case"vertex-add":this.emit(a.type,{...a,added:g,vertices:c});break;case"vertex-update":this.emit(a.type,{...a,updated:g,vertices:c});break;case"vertex-remove":this.emit(a.type,{...a,removed:g,vertices:c})}const u=this._activeComponent.getLastVertex(),y=u!=null?this.coordinateHelper.vectorToDehydratedPoint(u.pos):null;y!=null&&this.lastVertex!=null&&ze(this.lastVertex,y)||(this.lastVertex=y)}));const p=this._manipulator=new oi({grabbableForEvent:a=>this.drawingMode!=="click"||a.pointerType==="touch"&&this._snappingEnabled&&this._pointerDownStates.size===1});this.manipulators.add(p),p.grabbable=t!=="point",this.addHandles([this._createManipulatorDragPipeline(p),p.events.on("immediate-click",a=>this._onImmediateClick(a)),p.events.on("immediate-double-click",a=>this._onImmediateDoubleClick(a)),A(()=>({cursor:this.cursor,loading:this.loading}),({cursor:a,loading:c})=>{p.cursor=c?"progress":a},ie)]),wt(this,()=>{const a=this.view.inputManager.latestPointerType??"mouse",c=this._getSnappingContext(a);this.snappingManager!=null&&this.updatingHandles.addPromise(be(this._snappingOperation.resnap(this.snappingManager,c)))})}destroy(){G(this.segmentLabels),G(this._snappingOperation),this._editGeometryOperations=G(this._editGeometryOperations)}get _snappingEnabled(){return this.snappingManager!=null&&this.snappingManager.options.effectiveEnabled}get _requiresScenePoint(){const t=this._getEffectiveDrawSurface();return this.view.type==="3d"&&this.drawSurface!==t}get canRedo(){return this._editGeometryOperations.canRedo}get canUndo(){return this._editGeometryOperations.canUndo}get committedVertices(){return this._activeComponent.vertices.map(t=>this.coordinateHelper.vectorToArray(t.pos))}set drawingMode(t){this._set("drawingMode",t??Ke)}get interactive(){return this._manipulator.interactive}set interactive(t){this._manipulator.interactive=t}get isCompleted(){return this._createOperationCompleted}get numCommittedVertices(){return this._activeComponent.vertices.length}get numVertices(){return this.stagedVertex!=null?this._activeComponent.vertices.length+1:this._activeComponent.vertices.length}get snappingOptions(){return this.snappingManager!=null?this.snappingManager.options:null}get stagedVertex(){return this._snappingOperation.stagedPoint}set stagedVertex(t){this._snappingOperation.stagedPoint=Ae(t)}get updating(){return this.updatingHandles.updating}get vertices(){const t=this.committedVertices;return this.stagedVertex!=null&&t.push(this.coordinateHelper.pointToArray(this.stagedVertex)),t}cancel(){this.complete({aborted:!0})}commitStagedVertex(){if(this._snappingOperation.abort(),this.stagedVertex!=null){const{stagedVertex:t}=this;this.stagedVertex=null,this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(t))}}complete(t){const e=t&&t.aborted||!1;this._snappingOperation.abort(),this.snappingManager!=null&&this.snappingManager.doneSnapping(),this.geometryType==="segment"||this.geometryType==="point"?this.commitStagedVertex():this.stagedVertex=null;const i=this.geometryType==="multipoint"&&this.numVertices===0||this.geometryType==="polyline"&&this.numVertices<2||this.geometryType==="polygon"&&this.numVertices<3;this._createOperationCompleted=!i,(this.isCompleted||e)&&this.emit("complete",{vertices:this.vertices.map((n,o)=>({componentIndex:0,vertexIndex:o,coordinates:n})),aborted:e,type:"complete"})}onInputEvent(t){switch(t.type){case"pointer-down":this._pointerDownStates.add(t.pointerId);break;case"pointer-up":this._pointerDownStates.delete(t.pointerId)}switch(t.type){case"pointer-move":return this._onPointerMove(t);case"hold":return this._onHold(t)}}redo(){this._editGeometryOperations.redo()}undo(){this.snappingManager!=null&&this.snappingManager.doneSnapping(),this._editGeometryOperations.undo()}_closeOnClickVertexIndex(t){const e=this._activeComponent;if(this.geometryType==="polygon"&&e.vertices.length>2){if(this._vertexWithinPointerDistance(e.vertices[0].pos,t))return 0;if(this._vertexWithinPointerDistance(e.vertices[e.vertices.length-1].pos,t))return e.vertices.length-1}return null}_createManipulatorDragPipeline(t){switch(this.drawingMode){case"click":return this._createManipulatorDragPipelineClick(t);case"freehand":return this._createManipulatorDragPipelineFreehand(t);case"hybrid":return this._createManipulatorDragPipelineHybrid(t)}}_createManipulatorDragPipelineClick(t){return ce(t,(e,i,n,o)=>{const r=o==="touch"&&this._snappingEnabled;if(this.isCompleted||!r)return;const{snappingStep:p,cancelSnapping:a}=Yt({predicate:()=>r,snappingManager:this.snappingManager,snappingContext:new Ee({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:o,visualizer:this.snappingVisualizer}),updatingHandles:this.updatingHandles,useZ:!this._requiresScenePoint});n=n.next(c=>(r&&this.snappingManager!=null&&this.snappingManager.doneSnapping(),c)).next(a),i.next(this._screenToMapDragEventStep()).next(c=>(c.action==="start"&&(this.stagedVertex=c.mapStart,(this.geometryType==="segment"||r&&this.numVertices===0)&&this.commitStagedVertex()),c)).next(Dt(this.view,this.elevationInfo)).next(...p).next(c=>(r&&(this.stagedVertex=c.mapEnd,c.action==="end"&&this.commitStagedVertex()),c)).next(c=>(c.action==="end"&&(this.geometryType!=="segment"&&this.geometryType!=="point"||this.complete()),c))})}_createManipulatorDragPipelineFreehand(t){return ce(t,(e,i)=>{this.isCompleted||i.next(this._screenToMapDragEventStep()).next(n=>(n.action==="start"&&(this.stagedVertex==null&&(this.stagedVertex=n.mapStart),this.geometryType==="segment"&&this.commitStagedVertex()),n)).next(n=>{switch(n.action){case"start":case"update":this.stagedVertex=n.mapEnd,this.geometryType!=="polygon"&&this.geometryType!=="polyline"||this.commitStagedVertex();break;case"end":this.complete()}return n})})}_createManipulatorDragPipelineHybrid(t){return ce(t,(e,i)=>{this.isCompleted||i.next(this._screenToMapDragEventStep()).next(n=>(n.action==="start"&&(this.stagedVertex==null&&(this.stagedVertex=n.mapStart),this.commitStagedVertex()),n)).next(n=>{switch(n.action){case"start":case"update":this.stagedVertex=n.mapEnd,this.geometryType!=="polygon"&&this.geometryType!=="polyline"||this.commitStagedVertex();break;case"end":this.geometryType!=="segment"&&this.geometryType!=="point"||this.complete()}return n})})}get _drawAtFixedElevation(){return(this.geometryType==="segment"||this.geometryType==="polygon")&&this.numCommittedVertices>0}_getEffectiveDrawSurface(){if(this.elevationDrawSurface==null)return this.drawSurface;if(!this.coordinateHelper.hasZ())return this.elevationDrawSurface.defaultZ=null,this.elevationDrawSurface;let t=this.defaultZ,e=!1;return this.elevationInfo!=null&&this.elevationInfo.mode==="absolute-height"&&(e=!0),this.snapToSceneEnabled!=null&&(e=this.snapToSceneEnabled),this.elevationInfo!=null&&this.elevationInfo.mode==="on-the-ground"&&(e=!1),this._drawAtFixedElevation&&(t=this.coordinateHelper.getZ(this._activeComponent.vertices[0].pos),e=!1),e?this.drawSurface:(this.elevationDrawSurface.defaultZ=t,this.elevationDrawSurface)}_mapToScreen(t){var e;return(e=this._getEffectiveDrawSurface())==null?void 0:e.mapToScreen(t)}_onHold(t){this._snappingOperation.abort(),this.drawingMode==="click"&&t.pointerType==="touch"&&this._snappingEnabled&&(this.stagedVertex=t.mapPoint),t.stopPropagation()}_onImmediateClick(t){if(t.pointerType==="mouse"&&t.button===2||this._manipulator.dragging)return;const e=this._activeComponent;if(this._closeOnClickVertexIndex(t.screenPoint)!=null)return t.stopPropagation(),void this.complete();const i=this._screenToMap(t.screenPoint);if(i!=null)switch(this.drawingMode){case"freehand":this.geometryType==="point"&&(this.stagedVertex!=null?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(i)),this.complete());break;case"click":case"hybrid":this._snappingOperation.abort(),this.stagedVertex!=null?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(i)),(this.geometryType==="point"||this.geometryType==="segment"&&e.vertices.length===2||this.geometryType==="segment"&&this.drawingMode==="hybrid"&&e.vertices.length===1)&&this.complete()}t.stopPropagation()}_onImmediateDoubleClick(t){this._manipulator.dragging||this.geometryType==="point"||(this.complete(),t.stopPropagation())}_onPointerMove(t){const e=Tt(t.x,t.y);this._stagedScreenPoint=e,this._stagedPointerType=t.pointerType;const i=this._snappingOperation,n=this._manipulator;n.dragging||this._pointerDownStates.has(t.pointerId)||n.grabbing||!n.interactive?i.abort():(t.stopPropagation(),this._updateStagedVertexOnPointerMove(e,t.pointerType))}_onViewpointChange(){const t=this._manipulator;this._stagedScreenPoint&&!t.dragging&&!t.grabbing&&t.interactive?this._updateStagedVertexOnPointerMove(this._stagedScreenPoint,this._stagedPointerType??"mouse"):this._snappingOperation.abort()}_updateStagedVertexOnPointerMove(t,e){var c;const i=this._snappingOperation,n=this._closeOnClickVertexIndex(t);if(n!=null)return this._closeOnVertex(n),void i.abort();const o=this._screenToMap(t),r=this._requiresScenePoint?(c=this.drawSurface)==null?void 0:c.screenToMap(t):null;if(o==null)return this.cursor=null,void i.abort();this.cursor="crosshair";const p=this.snappingManager;if(p==null)return this.stagedVertex=o,void i.abort();const a=this._getSnappingContext(e);this.updatingHandles.addPromise(be(i.snap({point:o,scenePoint:r},p,a)))}_closeOnVertex(t){this.stagedVertex=null;const e={componentIndex:0,vertexIndex:t,coordinates:this.coordinateHelper.vectorToArray(this._activeComponent.vertices[t].pos)};this.emit("cursor-update",{updated:null,vertices:[e],operation:"apply",type:"vertex-update"})}_screenToMap(t){var e;return(e=this._getEffectiveDrawSurface())==null?void 0:e.screenToMap(t)}_screenToMapDragEventStep(){let t=null;return e=>{if(e.action==="start"&&(t=this._screenToMap(e.screenStart)),t==null)return null;const i=this._screenToMap(e.screenEnd);return i!=null?{...e,mapStart:t,mapEnd:i}:null}}_vertexWithinPointerDistance(t,e){const n=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(t));return n!=null&&ri(n,e,25)}_getSnappingContext(t){const e=this._drawAtFixedElevation?bt(this.elevationDrawSurface,({defaultZ:i})=>i):null;return new Ee({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:t,visualizer:this.snappingVisualizer,selfSnappingZ:e!=null?{value:e,elevationInfo:this.elevationInfo}:null})}};function ri(t,e,i){const n=t.x-e.x,o=t.y-e.y;return n*n+o*o<=i}s([l()],f.prototype,"_snappingEnabled",null),s([l()],f.prototype,"defaultZ",void 0),s([l()],f.prototype,"isDraped",void 0),s([l({value:Ke})],f.prototype,"drawingMode",null),s([l({constructOnly:!0})],f.prototype,"elevationDrawSurface",void 0),s([l({constructOnly:!0})],f.prototype,"elevationInfo",void 0),s([l({constructOnly:!0,type:re})],f.prototype,"labelOptions",void 0),s([l({constructOnly:!0,type:se})],f.prototype,"tooltipOptions",void 0),s([l({constructOnly:!0})],f.prototype,"geometryType",void 0),s([l({constructOnly:!0})],f.prototype,"hasM",void 0),s([l({constructOnly:!0})],f.prototype,"hasZ",void 0),s([l()],f.prototype,"cursor",void 0),s([l()],f.prototype,"loading",void 0),s([l({constructOnly:!0})],f.prototype,"manipulators",void 0),s([l({constructOnly:!0})],f.prototype,"drawSurface",void 0),s([l({constructOnly:!0})],f.prototype,"segmentLabels",void 0),s([l({constructOnly:!0})],f.prototype,"snappingManager",void 0),s([l({constructOnly:!0})],f.prototype,"snappingVisualizer",void 0),s([l()],f.prototype,"snapToSceneEnabled",void 0),s([l()],f.prototype,"_snappingOperation",void 0),s([l()],f.prototype,"stagedVertex",null),s([l()],f.prototype,"lastVertex",void 0),s([l()],f.prototype,"updating",null),s([l({constructOnly:!0})],f.prototype,"view",void 0),f=s([z("esri.views.draw.DrawOperation")],f);class Mi{constructor(e,i,n,o=null){this._elevationInfo=e,this.defaultZ=i,this._view=n,this._excludeGraphics=o}screenToMap(e){if(this.defaultZ!=null)return this._view.sceneIntersectionHelper.intersectElevationFromScreen(Oe(e.x,e.y),this._elevationInfo,this.defaultZ,this._excludeGraphics);const i=this._view.sceneIntersectionHelper.intersectElevationFromScreen(Oe(e.x,e.y),this._elevationInfo,0,this._excludeGraphics);return i!=null&&(i.z=void 0),i}mapToScreen(e){const i=je(e.x,e.y,me(this._view,e,this._elevationInfo),e.spatialReference);return this._view.toScreen(i)}constrainZ(e){const{defaultZ:i}=this;return i!=null&&e.z!==i&&((e=qe(e)).z=i),e}}class Si{constructor(e,i,n=[]){this.view=e,this.elevationInfo=i,this.exclude=n}screenToMap(e){const i=this.view.toMap(e,{exclude:this.exclude});return i!=null&&(i.z=St(i,this.view,this.elevationInfo)),i}mapToScreen(e){let i=e;return this.elevationInfo!=null&&(i=je(e.x,e.y,me(this.view,e,this.elevationInfo),e.spatialReference)),this.view.toScreen(i)}constrainZ(e){return e}}class Vi{constructor(e,i=!1,n=0){this.view=e,this.hasZ=i,this.defaultZ=n,this.mapToScreen=o=>e.toScreen(o),this.screenToMap=i?o=>{const r=e.toMap(o);return r.z=n,r}:o=>e.toMap(o)}constrainZ(e){const{defaultZ:i}=this;return this.hasZ&&e.z!==i&&((e=qe(e)).z=i),e}}function Ii(t,e){return Qe(t,e,!1)}function $i(t,e){return Qe(t,e,!0)}function Qe(t,e,i){if(t instanceof Lt){if(t.operation instanceof At)return si(t.operation,e,i),!0;if(t.operation instanceof Nt)return ai(t.operation,e,i),!0;if(t.operation instanceof jt)return li(t.operation,e,i),!0}return!1}function si(t,e,i=!1){const n=i?-1:1,o=Vt(n*t.dx,n*t.dy,n*t.dz);B(e.origin,e.origin,o)}function ai(t,e,i=!1){const n=i?-t.angle:t.angle;Me(e.basis1,e.basis1,Se,n),Me(e.basis2,e.basis2,Se,n)}function li(t,e,i=!1){const n=i?1/t.factor1:t.factor1,o=i?1/t.factor2:t.factor2;N(e.basis1,e.basis1,n),N(e.basis2,e.basis2,o),Ve(e.origin,e.origin,t.origin,t.axis1,n),Ve(e.origin,e.origin,t.origin,t.axis2,o)}function Ci(t,e,i,n){n||(n=Ye());const o=U(Y.get(),t[1],-t[0]),r=U(Y.get(),Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),p=U(Y.get(),Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),a=Y.get();e.components.forEach(u=>u.vertices.forEach(y=>{const m=y.pos;U(a,Ie(t,m),Ie(o,m)),It(r,r,a),$t(p,p,a)}));const c=1e-6,g=U(Y.get(),p[0]-r[0]<c?i/2:0,p[1]-r[1]<c?i/2:0);return Ct(r,r,g),le(p,p,g),$e(n.basis1,t,(p[0]-r[0])/2),$e(n.basis2,o,(p[1]-r[1])/2),U(n.origin,r[0]*t[0]+r[1]*o[0],r[0]*t[1]+r[1]*o[1]),le(n.origin,n.origin,n.basis1),le(n.origin,n.origin,n.basis2),n}function Pi(t,e,i,n=0,o){o||(o=Ye()),e.toRenderCoords(t.origin,i,o.origin);const r=T.get();B(r,t.origin,t.basis1),B(r,r,t.basis2),e.toRenderCoords(r,i,r);const p=T.get();B(p,t.origin,t.basis1),O(p,p,t.basis2),e.toRenderCoords(p,i,p);const a=T.get();O(a,t.origin,t.basis1),O(a,a,t.basis2),e.toRenderCoords(a,i,a);const c=T.get();O(c,t.origin,t.basis1),B(c,c,t.basis2),e.toRenderCoords(c,i,c);const g=E(T.get(),r,p,.5);O(g,g,o.origin);const u=E(T.get(),a,c,.5);O(u,o.origin,u),E(o.basis1,g,u,.5);const y=E(T.get(),c,r,.5);O(y,y,o.origin);const m=E(T.get(),p,a,.5);O(m,o.origin,m),E(o.basis2,y,m,.5);const h=de(T.get(),o.basis1,o.basis2),x=de(h,h,o.basis1);return We(x,x),N(o.basis2,x,Ue(o.basis2,x)),N(o.basis1,o.basis1,1+n/Ce(o.basis1)),N(o.basis2,o.basis2,1+n/Ce(o.basis2)),Pt(o),o}function Ri(t,e,i,n){const o=T.get();O(o,O(o,t.origin,t.basis1),t.basis2);const r=T.get();pe(r,o,t.basis1,2);const p=T.get();pe(p,r,t.basis2,2);const a=T.get();pe(a,o,t.basis2,2),o[2]=r[2]=p[2]=a[2]=e;const c=n?"on-the-ground":"absolute-height",g=Re(K(o,r,i,c),K(a,p,i,c)),u=Re(K(r,p,i,c),K(o,a,i,c));return u==null||g==null?null:[g,u]}export{d as E,Ii as F,Pi as G,Oi as H,f as I,Ri as M,$i as S,Ci as U,Vi as c,Si as o,Mi as r};
